Imports System.Numerics

Module ModWire
    Public Function WireSize(ByVal Conductor As String, ByVal NominalTemp As Integer, ByVal Current As Decimal, ByVal Conduit As String, ByVal Wire As String) As String
        Dim Ampacity(21) As Integer
        Dim Size(21) As String
        Dim v As Integer

        Size = {"0", "2.0", "3.5", "5.5", "8.0", "14", "22", "30", "38", "50", "60", "80", "100", "125", "150", "175", "200", "250", "325", "375", "400", "500"}

        If Conduit = "Air" Then
            Select Case Conductor
                Case "Cu"
                    Select Case NominalTemp
                        Case 60
                            Ampacity = {0, 25, 30, 40, 55, 80, 105, 125, 145, 180, 200, 245, 285, 335, 375, 410, 440, 510, 600, 645, 660, 755}
                        Case 75
                            Ampacity = {0, 30, 35, 50, 65, 100, 130, 150, 175, 210, 235, 290, 340, 400, 445, 495, 530, 620, 720, 775, 795, 905}
                        Case 90
                            Ampacity = {0, 35, 40, 55, 75, 110, 145, 165, 195, 235, 265, 325, 380, 445, 505, 560, 590, 685, 800, 875, 890, 1020}
                    End Select
                Case Else
                    Select Case NominalTemp
                        Case 60
                            Ampacity = {0, 0, 25, 35, 45, 65, 85, 95, 115, 135, 155, 185, 220, 260, 295, 325, 345, 405, 475, 510, 520, 605}
                        Case 75
                            Ampacity = {0, 0, 30, 40, 50, 80, 105, 115, 135, 165, 185, 225, 265, 310, 355, 390, 410, 485, 560, 615, 630, 730}
                        Case 90
                            Ampacity = {0, 0, 35, 40, 55, 85, 115, 130, 155, 185, 210, 255, 295, 350, 400, 440, 465, 545, 640, 690, 705, 820}
                    End Select
            End Select
        Else
            Select Case Conductor
                Case "Cu"
                    Select Case NominalTemp
                        Case 60
                            Ampacity = {0, 15, 20, 30, 40, 55, 70, 85, 100, 115, 130, 155, 185, 210, 240, 260, 275, 315, 370, 395, 400, 445}
                        Case 75
                            Ampacity = {0, 20, 25, 35, 50, 65, 85, 100, 115, 140, 155, 190, 220, 255, 285, 305, 325, 375, 435, 470, 480, 530}
                        Case 90
                            Ampacity = {0, 25, 30, 40, 55, 75, 95, 115, 130, 150, 170, 205, 240, 285, 320, 345, 360, 425, 490, 530, 535, 595}
                    End Select
                Case Else
                    Select Case NominalTemp
                        Case 60
                            Ampacity = {0, 0, 15, 25, 30, 40, 55, 65, 75, 90, 100, 120, 140, 165, 190, 205, 220, 255, 300, 315, 320, 365}
                        Case 75
                            Ampacity = {0, 0, 20, 30, 40, 50, 65, 80, 90, 110, 120, 145, 170, 200, 230, 245, 265, 305, 355, 380, 385, 435}
                        Case 90
                            Ampacity = {0, 0, 25, 35, 45, 65, 80, 90, 105, 125, 135, 165, 190, 225, 255, 175, 300, 345, 405, 430, 440, 485}
                    End Select
            End Select
        End If

        If Wire = "FEP" Or Wire = "FEPB" Or Wire = "ZW" Then
            For i As Integer = 1 To 7 Step 1
                If Current > Ampacity(i - 1) And Current <= Ampacity(i) Then
                    v = i
                    GoTo ReturnLine
                End If
            Next i
        ElseIf Wire = "PFA" Or Wire = "PFAH" Or Wire = "TFE" Or Wire = "Z" Then
            For i As Integer = 1 To 11 Step 1
                If Current > Ampacity(i - 1) And Current <= Ampacity(i) Then
                    v = i
                    GoTo ReturnLine
                End If
            Next i
        Else
            For i As Integer = 1 To 21 Step 1
                If Current > Ampacity(i - 1) And Current <= Ampacity(i) Then
                    v = i
                    GoTo ReturnLine
                End If
            Next i
        End If

ReturnLine: Return Size(v)
    End Function

    Public Function WireSet(ByVal Conductor As String, ByVal NominalTemp As Integer, ByVal Current As Decimal, ByVal Conduit As String, Wire As String) As Integer
        Dim v As Integer

        If (Wire = "FEP" Or Wire = "FEPB") And Conduit = "Air" Then
            Select Case Conductor
                Case "Cu"
                    If Current > 165 Then
                        v = Math.Truncate(Current / 165) + 1
                    Else
                        v = 1
                    End If
                Case Else
                    If Current > 130 Then
                        v = Math.Truncate(Current / 130) + 1
                    Else
                        v = 1
                    End If
            End Select
        ElseIf (Wire = "FEP" Or Wire = "FEPB") And Conduit IsNot "Air" Then
            Select Case Conductor
                Case "Cu"
                    If Current > 115 Then
                        v = Math.Truncate(Current / 115) + 1
                    Else
                        v = 1
                    End If
                Case Else
                    If Current > 90 Then
                        v = Math.Truncate(Current / 90) + 1
                    Else
                        v = 1
                    End If
            End Select
        ElseIf Wire = "ZW" And Conduit = "Air" Then
            Select Case Conductor
                Case "Cu"
                    If Current > 150 Then
                        v = Math.Truncate(Current / 150) + 1
                    Else
                        v = 1
                    End If
                Case Else
                    If Current > 115 Then
                        v = Math.Truncate(Current / 115) + 1
                    Else
                        v = 1
                    End If
            End Select
        ElseIf Wire = "ZW" And Conduit IsNot "Air" Then
            Select Case Conductor
                Case "Cu"
                    If Current > 100 Then
                        v = Math.Truncate(Current / 100) + 1
                    Else
                        v = 1
                    End If
                Case Else
                    If Current > 80 Then
                        v = Math.Truncate(Current / 80) + 1
                    Else
                        v = 1
                    End If
            End Select
        Else
            If Conduit IsNot "Air" And Conductor = "Cu" Then
                Select Case NominalTemp
                    Case 60
                        If Current > 445 Then
                            v = Math.Truncate(Current / 445) + 1
                        Else
                            v = 1
                        End If
                    Case 75
                        If Current > 530 Then
                            v = Math.Truncate(Current / 530) + 1
                        Else
                            v = 1
                        End If
                    Case 90
                        If Current > 595 Then
                            v = Math.Truncate(Current / 595) + 1
                        Else
                            v = 1
                        End If
                End Select

            ElseIf Conduit IsNot "Air" And Conductor IsNot "Cu" Then
                Select Case NominalTemp
                    Case 60
                        If Current > 365 Then
                            v = Math.Truncate(Current / 365) + 1
                        Else
                            v = 1
                        End If
                    Case 75
                        If Current > 435 Then
                            v = Math.Truncate(Current / 435) + 1
                        Else
                            v = 1
                        End If
                    Case 90
                        If Current > 485 Then
                            v = Math.Truncate(Current / 485) + 1
                        Else
                            v = 1
                        End If
                End Select

            ElseIf Conduit = "Air" And Conductor = "Cu" Then
                Select Case NominalTemp
                    Case 60
                        If Current > 755 Then
                            v = Math.Truncate(Current / 755) + 1
                        Else
                            v = 1
                        End If
                    Case 75
                        If Current > 905 Then
                            v = Math.Truncate(Current / 905) + 1
                        Else
                            v = 1
                        End If
                    Case 90
                        If Current > 1020 Then
                            v = Math.Truncate(Current / 1020) + 1
                        Else
                            v = 1
                        End If
                End Select

            ElseIf Conduit = "Air" And Conductor IsNot "Cu" Then
                Select Case NominalTemp
                    Case 60
                        If Current > 605 Then
                            v = Math.Truncate(Current / 605) + 1
                        Else
                            v = 1
                        End If
                    Case 75
                        If Current > 730 Then
                            v = Math.Truncate(Current / 730) + 1
                        Else
                            v = 1
                        End If
                    Case 90
                        If Current > 820 Then
                            v = Math.Truncate(Current / 820) + 1
                        Else
                            v = 1
                        End If
                End Select
            End If
        End If

        Return v
    End Function

    Public Function ConduitSize(ByVal WireType As String, ConductorSize As String, Ground As Boolean, Phase As String, ConduitType As String, Neutral As Boolean) As Integer
        Dim WireSize = {"2.0", "3.5", "5.5", "8.0", "14", "22", "30", "38", "50", "60", "80", "100", "125", "150", "175", "200", "250", "325", "375", "400", "500"}
        Dim NominalSize = {10, 15, 20, 25, 32, 40, 50, 65, 80, 90, 100, 125, 150}
        Dim v, w, z As Integer
        Dim Conduit(20, 12) As Integer

        For i As Integer = 0 To 20 Step 1
            If ConductorSize = WireSize(i) Then
                v = i
            End If
        Next i

        If ConduitType = "EMT" Then
            Select Case WireType
                Case "RHH", "RHW", "RHW-2"
                    Conduit = {{0, 4, 7, 11, 20, 27, 46, 80, 120, 157, 201, 0, 0},
                        {0, 3, 6, 9, 17, 23, 38, 66, 100, 131, 167, 0, 0},
                        {0, 2, 5, 8, 13, 18, 30, 53, 81, 105, 135, 0, 0},
                        {0, 1, 2, 4, 7, 9, 16, 28, 42, 55, 70, 0, 0},
                        {0, 1, 1, 3, 5, 8, 13, 22, 34, 44, 56, 0, 0},
                        {0, 1, 1, 2, 4, 6, 10, 17, 26, 34, 44, 0, 0},
                        {0, 1, 1, 1, 3, 4, 7, 13, 20, 26, 33, 0, 0},
                        {0, 0, 1, 1, 1, 3, 5, 9, 13, 17, 22, 0, 0},
                        {0, 0, 1, 1, 1, 2, 4, 7, 11, 15, 19, 0, 0},
                        {0, 0, 1, 1, 1, 2, 4, 6, 10, 13, 17, 0, 0},
                        {0, 0, 0, 1, 1, 1, 3, 5, 8, 11, 14, 0, 0},
                        {0, 0, 0, 1, 1, 1, 3, 5, 7, 9, 12, 0, 0},
                        {0, 0, 0, 0, 1, 1, 1, 3, 5, 7, 9, 0, 0},
                        {0, 0, 0, 0, 1, 1, 1, 3, 5, 6, 8, 0, 0},
                        {0, 0, 0, 0, 1, 1, 1, 3, 4, 6, 7, 0, 0},
                        {0, 0, 0, 0, 1, 1, 1, 2, 4, 5, 7, 0, 0},
                        {0, 0, 0, 0, 0, 1, 1, 2, 3, 4, 6, 0, 0},
                        {0, 0, 0, 0, 0, 0, 1, 1, 2, 3, 4, 0, 0},
                        {0, 0, 0, 0, 0, 0, 1, 1, 2, 3, 4, 0, 0},
                        {0, 0, 0, 0, 0, 0, 1, 1, 2, 3, 4, 0, 0},
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 0, 0},
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 0, 0}}
                Case "TW", "THHW", "THW", "THW-2"
                    Conduit = {{0, 8, 15, 25, 43, 58, 96, 168, 254, 332, 424, 0, 0},
                        {0, 6, 11, 19, 33, 45, 74, 129, 195, 255, 326, 0, 0},
                        {0, 5, 8, 14, 24, 33, 55, 96, 145, 190, 243, 0, 0},
                        {0, 2, 5, 8, 13, 18, 30, 53, 81, 105, 135, 0, 0},
                        {0, 1, 3, 4, 8, 11, 18, 32, 48, 63, 81, 0, 0},
                        {0, 1, 1, 3, 6, 8, 13, 24, 36, 47, 60, 0, 0},
                        {0, 1, 1, 2, 4, 6, 10, 17, 26, 34, 44, 0, 0},
                        {0, 1, 1, 1, 3, 4, 7, 12, 18, 24, 31, 0, 0},
                        {0, 0, 1, 1, 2, 3, 6, 10, 16, 20, 26, 0, 0},
                        {0, 0, 1, 1, 1, 3, 5, 9, 13, 17, 22, 0, 0},
                        {0, 0, 1, 1, 1, 2, 4, 7, 11, 15, 19, 0, 0},
                        {0, 0, 0, 1, 1, 1, 3, 6, 9, 12, 16, 0, 0},
                        {0, 0, 0, 1, 1, 1, 3, 5, 7, 10, 13, 0, 0},
                        {0, 0, 0, 1, 1, 1, 2, 4, 6, 8, 11, 0, 0},
                        {0, 0, 0, 0, 1, 1, 1, 4, 6, 7, 10, 0, 0},
                        {0, 0, 0, 0, 1, 1, 1, 3, 5, 7, 9, 0, 0},
                        {0, 0, 0, 0, 1, 1, 1, 3, 4, 6, 7, 0, 0},
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 5, 0, 0},
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 5, 0, 0},
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 5, 0, 0},
                        {0, 0, 0, 0, 0, 0, 1, 1, 2, 3, 4, 0, 0},
                        {0, 0, 0, 0, 0, 0, 1, 1, 2, 3, 4, 0, 0}}
                Case "THHN", "THWN", "THWN-2"
                    Conduit = {{0, 12, 22, 35, 61, 84, 138, 241, 364, 476, 608, 0, 0},
                        {0, 9, 16, 26, 45, 61, 101, 175, 266, 347, 443, 0, 0},
                        {0, 5, 10, 16, 28, 38, 63, 111, 167, 219, 279, 0, 0},
                        {0, 3, 6, 9, 16, 22, 36, 64, 96, 126, 161, 0, 0},
                        {0, 2, 4, 7, 12, 16, 26, 46, 69, 91, 116, 0, 0},
                        {0, 1, 2, 4, 7, 10, 16, 28, 43, 56, 71, 0, 0},
                        {0, 1, 1, 3, 5, 7, 11, 20, 30, 40, 51, 0, 0},
                        {0, 1, 1, 1, 4, 5, 8, 15, 22, 29, 37, 0, 0},
                        {0, 1, 1, 1, 3, 4, 7, 12, 19, 25, 32, 0, 0},
                        {0, 0, 1, 1, 2, 3, 6, 10, 16, 20, 26, 0, 0},
                        {0, 0, 1, 1, 1, 3, 5, 8, 13, 17, 22, 0, 0},
                        {0, 0, 1, 1, 1, 2, 4, 7, 11, 14, 18, 0, 0},
                        {0, 0, 0, 1, 1, 1, 3, 6, 9, 11, 15, 0, 0},
                        {0, 0, 0, 1, 1, 1, 3, 5, 7, 10, 13, 0, 0},
                        {0, 0, 0, 1, 1, 1, 2, 4, 6, 9, 11, 0, 0},
                        {0, 0, 0, 0, 1, 1, 1, 4, 6, 8, 10, 0, 0},
                        {0, 0, 0, 0, 1, 1, 1, 3, 5, 6, 8, 0, 0},
                        {0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 6, 0, 0},
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 5, 0, 0},
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 5, 0, 0},
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 4, 0, 0},
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 0, 0}}
                Case "FEP", "FEPB"
                    Conduit = {{0, 12, 21, 34, 60, 81, 134, 234, 354, 462, 590, 0, 0},
                        {0, 9, 15, 25, 43, 59, 98, 171, 258, 337, 430, 0, 0},
                        {0, 6, 11, 18, 31, 42, 70, 122, 185, 240, 309, 0, 0},
                        {0, 3, 6, 10, 18, 24, 40, 70, 106, 138, 177, 0, 0},
                        {0, 2, 4, 7, 12, 17, 28, 50, 75, 98, 126, 0, 0},
                        {0, 1, 3, 5, 9, 12, 20, 35, 53, 69, 88, 0, 0},
                        {0, 1, 1, 3, 6, 8, 13, 24, 36, 47, 60, 0, 0}}
                Case "PFA", "PFAH", "TFE"
                    Conduit = {{0, 12, 21, 34, 60, 81, 134, 234, 354, 462, 590, 0, 0},
                        {0, 9, 15, 25, 43, 59, 98, 171, 258, 337, 430, 0, 0},
                        {0, 6, 11, 18, 31, 42, 70, 122, 185, 240, 309, 0, 0},
                        {0, 3, 6, 10, 18, 24, 40, 70, 106, 138, 177, 0, 0},
                        {0, 2, 4, 7, 12, 17, 28, 50, 75, 98, 126, 0, 0},
                        {0, 1, 3, 5, 9, 12, 20, 35, 53, 69, 88, 0, 0},
                        {0, 1, 1, 3, 6, 8, 13, 24, 36, 47, 60, 0, 0},
                        {0, 1, 1, 2, 4, 6, 9, 16, 25, 33, 42, 0, 0},
                        {0, 1, 1, 1, 3, 5, 8, 14, 21, 27, 35, 0, 0},
                        {0, 0, 1, 1, 3, 4, 6, 11, 17, 22, 29, 0, 0},
                        {0, 0, 1, 1, 2, 3, 5, 9, 14, 18, 24, 0, 0},
                        {0, 0, 1, 1, 1, 2, 4, 8, 11, 15, 19, 0, 0}}
                Case "Z"
                    Conduit = {{0, 14, 25, 41, 72, 98, 161, 282, 426, 556, 711, 0, 0},
                        {0, 10, 18, 29, 51, 69, 114, 200, 302, 394, 504, 0, 0},
                        {0, 6, 11, 18, 31, 42, 70, 122, 185, 241, 309, 0, 0},
                        {0, 4, 7, 11, 20, 27, 44, 77, 117, 153, 195, 0, 0},
                        {0, 3, 5, 8, 14, 19, 31, 54, 82, 107, 137, 0, 0},
                        {0, 1, 3, 5, 9, 13, 21, 37, 56, 74, 94, 0, 0},
                        {0, 1, 1, 3, 6, 8, 13, 22, 34, 45, 57, 0, 0},
                        {0, 1, 1, 2, 4, 6, 10, 18, 28, 36, 46, 0, 0},
                        {0, 1, 1, 1, 3, 5, 8, 14, 21, 27, 35, 0, 0},
                        {0, 0, 1, 1, 3, 4, 6, 11, 17, 22, 29, 0, 0},
                        {0, 0, 1, 1, 2, 3, 5, 9, 14, 18, 24, 0, 0},
                        {0, 0, 1, 1, 1, 2, 4, 8, 11, 15, 19, 0, 0}}
                Case "XHHW", "XHHW-2", "XHH"
                    Conduit = {{0, 8, 15, 25, 43, 58, 96, 168, 254, 332, 424, 0, 0},
                        {0, 6, 11, 19, 33, 45, 74, 129, 195, 255, 326, 0, 0},
                        {0, 5, 8, 14, 24, 33, 55, 96, 145, 190, 243, 0, 0},
                        {0, 2, 5, 8, 13, 18, 30, 53, 81, 105, 135, 0, 0},
                        {0, 1, 3, 6, 10, 14, 22, 39, 60, 78, 100, 0, 0},
                        {0, 1, 2, 4, 7, 10, 16, 28, 43, 56, 72, 0, 0},
                        {0, 1, 1, 3, 5, 7, 11, 20, 31, 40, 51, 0, 0},
                        {0, 1, 1, 1, 4, 5, 8, 15, 23, 30, 38, 0, 0},
                        {0, 1, 1, 1, 3, 4, 7, 13, 19, 25, 32, 0, 0},
                        {0, 0, 1, 1, 2, 3, 6, 10, 16, 21, 27, 0, 0},
                        {0, 0, 1, 1, 1, 3, 5, 9, 13, 17, 22, 0, 0},
                        {0, 0, 1, 1, 1, 2, 4, 7, 11, 14, 18, 0, 0},
                        {0, 0, 0, 1, 1, 1, 3, 6, 9, 12, 15, 0, 0},
                        {0, 0, 0, 1, 1, 1, 3, 5, 8, 10, 13, 0, 0},
                        {0, 0, 0, 1, 1, 1, 2, 4, 7, 9, 11, 0, 0},
                        {0, 0, 0, 0, 1, 1, 1, 4, 6, 8, 10, 0, 0},
                        {0, 0, 0, 0, 1, 1, 1, 3, 5, 6, 8, 0, 0},
                        {0, 0, 0, 0, 0, 1, 1, 2, 3, 4, 6, 0, 0},
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 5, 0, 0},
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 5, 0, 0},
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 4, 0, 0},
                        {0, 0, 0, 0, 0, 0, 1, 1, 2, 3, 4, 0, 0}}
                Case "ZW"
                    Conduit = {{0, 8, 15, 25, 43, 58, 96, 168, 254, 332, 424, 0, 0},
                        {0, 6, 11, 19, 33, 45, 74, 129, 195, 255, 326, 0, 0},
                        {0, 5, 8, 14, 24, 33, 55, 96, 145, 190, 243, 0, 0},
                        {0, 2, 5, 8, 13, 18, 30, 53, 81, 105, 135, 0, 0},
                        {0, 1, 3, 6, 10, 14, 22, 39, 60, 78, 100, 0, 0},
                        {0, 1, 2, 4, 7, 10, 16, 28, 43, 56, 72, 0, 0},
                        {0, 1, 1, 3, 5, 7, 11, 20, 31, 40, 51, 0, 0}}
            End Select

        ElseIf ConduitType = "Rigid PVC 80" Then
            Select Case WireType
                Case "RHH", "RHW", "RHW-2"
                    Conduit = {{0, 3, 5, 9, 17, 23, 39, 56, 88, 119, 153, 243, 349}, '14
                        {0, 2, 4, 7, 14, 19, 32, 46, 73, 98, 127, 202, 290}, '12
                        {0, 1, 3, 6, 11, 15, 26, 37, 59, 79, 103, 163, 234}, '10
                        {0, 1, 1, 3, 6, 8, 13, 19, 31, 41, 54, 85, 122}, '8
                        {0, 1, 1, 2, 4, 6, 11, 16, 24, 33, 43, 68, 98}, '6
                        {0, 1, 1, 1, 3, 5, 8, 12, 19, 26, 33, 53, 77}, '4
                        {0, 0, 1, 1, 3, 4, 6, 9, 14, 20, 25, 41, 58}, '2
                        {0, 0, 1, 1, 1, 2, 4, 6, 9, 13, 17, 27, 38}, '1
                        {0, 0, 0, 1, 1, 1, 3, 5, 8, 11, 15, 23, 33}, '1/0
                        {0, 0, 0, 1, 1, 1, 3, 4, 7, 10, 13, 20, 29}, '2/0
                        {0, 0, 0, 1, 1, 1, 3, 4, 6, 8, 11, 17, 25}, '3/0
                        {0, 0, 0, 0, 1, 1, 2, 3, 5, 7, 9, 15, 21}, '4/0
                        {0, 0, 0, 0, 1, 1, 1, 2, 4, 5, 7, 11, 16}, '250
                        {0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 6, 10, 14}, '300
                        {0, 0, 0, 0, 1, 1, 1, 1, 3, 4, 5, 9, 13}, '350
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 5, 8, 12}, '400
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 10}, '500
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 7}, '700
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 7}, '750
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7}, '800
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 4, 6}, '900
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 4, 5}} '1000
                Case "TW", "THHW", "THW", "THW-2"
                    Conduit = {{0, 6, 11, 19, 35, 49, 82, 118, 185, 250, 324, 514, 736}, '14
                        {0, 4, 9, 15, 27, 38, 63, 91, 142, 192, 248, 394, 565}, '12
                        {0, 3, 6, 11, 20, 28, 47, 68, 106, 143, 185, 294, 421}, '10
                        {0, 1, 3, 6, 11, 15, 26, 37, 59, 79, 103, 163, 234}, '8
                        {0, 1, 1, 3, 7, 9, 16, 22, 35, 48, 62, 98, 141}, '6
                        {0, 1, 1, 3, 5, 7, 12, 17, 26, 35, 46, 73, 105}, '4
                        {0, 1, 1, 1, 3, 5, 8, 12, 19, 26, 33, 53, 77}, '2
                        {0, 0, 1, 1, 2, 3, 6, 8, 13, 18, 23, 37, 54}, '1
                        {0, 0, 1, 1, 1, 3, 5, 7, 11, 15, 20, 32, 46}, '1/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 10, 13, 17, 27, 39}, '2/0
                        {0, 0, 0, 1, 1, 1, 3, 5, 8, 11, 14, 23, 33}, '3/0
                        {0, 0, 0, 1, 1, 1, 3, 4, 7, 9, 12, 19, 27}, '4/0
                        {0, 0, 0, 0, 1, 1, 2, 3, 5, 7, 9, 15, 22}, '250
                        {0, 0, 0, 0, 1, 1, 1, 3, 5, 6, 8, 13, 19}, '300
                        {0, 0, 0, 0, 1, 1, 1, 2, 4, 6, 7, 12, 17}, '350
                        {0, 0, 0, 0, 1, 1, 1, 2, 4, 5, 7, 10, 15}, '400
                        {0, 0, 0, 0, 1, 1, 1, 1, 3, 4, 5, 9, 13}, '500
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 6, 9}, '700
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 6, 8}, '750
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 6, 8}, '800
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 7}, '900
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 7}} '1000
                Case "THHN", "THWN", "THWN-2"
                    Conduit = {{0, 9, 17, 28, 51, 70, 118, 170, 265, 358, 464, 736, 1055}, '14
                        {0, 6, 12, 20, 37, 51, 86, 124, 193, 261, 338, 537, 770}, '12
                        {0, 4, 7, 13, 23, 32, 54, 78, 122, 164, 213, 338, 485}, '10
                        {0, 2, 4, 7, 13, 18, 31, 45, 70, 95, 123, 195, 279}, '8
                        {0, 1, 3, 5, 9, 13, 22, 32, 51, 68, 89, 141, 202}, '6
                        {0, 1, 1, 3, 6, 8, 14, 20, 31, 42, 54, 86, 124}, '4
                        {0, 1, 1, 2, 4, 6, 10, 14, 22, 30, 39, 61, 88}, '2
                        {0, 0, 1, 1, 3, 4, 7, 10, 16, 22, 29, 45, 65}, '1
                        {0, 0, 1, 1, 2, 3, 6, 9, 14, 18, 24, 38, 55}, '1/0
                        {0, 0, 1, 1, 1, 3, 5, 7, 11, 15, 20, 32, 46}, '2/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 9, 13, 17, 26, 38}, '3/0
                        {0, 0, 0, 1, 1, 1, 3, 5, 8, 10, 14, 22, 31}, '4/0
                        {0, 0, 0, 1, 1, 1, 3, 4, 6, 8, 11, 18, 25}, '250
                        {0, 0, 0, 0, 1, 1, 2, 3, 5, 7, 9, 15, 22}, '300
                        {0, 0, 0, 0, 1, 1, 1, 3, 5, 6, 8, 13, 19}, '350
                        {0, 0, 0, 0, 1, 1, 1, 3, 4, 6, 7, 12, 17}, '400
                        {0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 6, 10, 14}, '500
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 10}, '700
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 9}, '750
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 6, 9}, '800
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 6, 8}, '900
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 7}} '1000
                Case "FEP", "FEPB"
                    Conduit = {{0, 8, 16, 27, 49, 68, 115, 164, 257, 347, 450, 714, 1024}, '14
                        {0, 6, 12, 20, 36, 50, 84, 120, 188, 253, 328, 521, 747}, '12
                        {0, 4, 8, 14, 26, 36, 60, 86, 135, 182, 235, 374, 536}, '10
                        {0, 2, 5, 8, 15, 20, 34, 49, 77, 104, 135, 214, 307}, '8
                        {0, 1, 3, 6, 10, 14, 24, 35, 55, 74, 96, 152, 218}, '6
                        {0, 1, 2, 4, 7, 10, 17, 24, 38, 52, 67, 106, 153}, '4
                        {0, 1, 1, 3, 5, 7, 12, 17, 26, 35, 46, 73, 105}} '2
                Case "PFA", "PFAH", "TFE"
                    Conduit = {{0, 8, 16, 27, 49, 68, 115, 164, 257, 347, 450, 714, 1024}, '14
                        {0, 6, 12, 20, 36, 50, 84, 120, 188, 253, 328, 521, 747}, '12
                        {0, 4, 8, 14, 26, 36, 60, 86, 135, 182, 235, 374, 536}, '10
                        {0, 2, 5, 8, 15, 20, 34, 49, 77, 104, 135, 214, 307}, '8
                        {0, 1, 3, 6, 10, 14, 24, 35, 55, 74, 96, 152, 218}, '6
                        {0, 1, 2, 4, 7, 10, 17, 24, 38, 52, 67, 106, 153}, '4
                        {0, 1, 1, 3, 5, 7, 12, 17, 26, 35, 46, 73, 105}, '2
                        {0, 1, 1, 1, 3, 5, 8, 11, 18, 25, 32, 51, 73}, '1
                        {0, 0, 1, 1, 3, 4, 7, 10, 15, 20, 27, 42, 61}, '1/0
                        {0, 0, 1, 1, 2, 3, 5, 8, 12, 17, 22, 35, 50}, '2/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 10, 14, 18, 29, 41}, '3/0
                        {0, 0, 0, 1, 1, 1, 4, 5, 8, 11, 15, 24, 34}} '4/0
                Case "Z"
                    Conduit = {{0, 10, 19, 33, 59, 82, 138, 198, 310, 418, 542, 860, 1233}, '14
                        {0, 7, 14, 23, 42, 58, 98, 141, 220, 297, 385, 610, 875}, '12
                        {0, 4, 8, 14, 26, 36, 60, 86, 135, 182, 235, 374, 536}, '10
                        {0, 3, 5, 9, 16, 22, 38, 54, 85, 115, 149, 236, 339}, '8
                        {0, 1, 4, 6, 11, 16, 26, 38, 60, 81, 104, 166, 238}, '6
                        {0, 1, 2, 4, 8, 11, 18, 26, 41, 55, 72, 114, 164}, '4
                        {0, 1, 1, 2, 5, 6, 11, 16, 25, 33, 43, 69, 99}, '2
                        {0, 1, 1, 1, 4, 5, 9, 13, 20, 27, 35, 56, 80}, '1
                        {0, 0, 1, 1, 3, 4, 7, 10, 15, 20, 27, 42, 61}, '1/0
                        {0, 0, 1, 1, 2, 3, 5, 8, 12, 17, 22, 35, 50}, '2/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 10, 14, 18, 29, 41}, '3/0
                        {0, 0, 0, 1, 1, 1, 4, 5, 8, 11, 15, 24, 34}} '4/0
                Case "XHHW", "XHHW-2", "XHH"
                    Conduit = {{0, 6, 11, 19, 35, 49, 82, 118, 185, 250, 324, 514, 736}, '14
                        {0, 4, 9, 15, 27, 38, 63, 91, 142, 192, 248, 394, 565}, '12
                        {0, 3, 6, 11, 20, 28, 47, 68, 106, 143, 185, 294, 421}, '10
                        {0, 1, 3, 6, 11, 15, 26, 37, 59, 79, 103, 163, 234}, '8
                        {0, 1, 2, 4, 8, 11, 19, 28, 43, 59, 76, 121, 173}, '6
                        {0, 1, 1, 3, 6, 8, 14, 20, 31, 42, 55, 87, 125}, '4
                        {0, 1, 1, 2, 4, 6, 10, 14, 22, 30, 39, 62, 89}, '2
                        {0, 0, 1, 1, 3, 4, 7, 10, 16, 22, 29, 46, 66}, '1
                        {0, 0, 1, 1, 2, 3, 6, 9, 14, 19, 24, 39, 56}, '1/0
                        {0, 0, 1, 1, 1, 3, 5, 7, 11, 16, 20, 32, 46}, '2/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 9, 13, 17, 27, 38}, '3/0
                        {0, 0, 0, 1, 1, 1, 3, 5, 8, 11, 14, 22, 32}, '4/0
                        {0, 0, 0, 1, 1, 1, 3, 4, 6, 9, 11, 18, 26}, '250
                        {0, 0, 0, 1, 1, 1, 2, 3, 5, 7, 10, 15, 22}, '300
                        {0, 0, 0, 0, 1, 1, 1, 3, 5, 6, 8, 14, 20}, '350
                        {0, 0, 0, 0, 1, 1, 1, 3, 4, 6, 7, 12, 17}, '400
                        {0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 6, 10, 14}, '500
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 10}, '700
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 6, 9}, '750
                        {0, 0, 0, 0, 0, 1, 1, 1, 1, 3, 4, 6, 9}, '800
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 5, 8}, '900
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 7}} '1000
                Case "ZW"
                    Conduit = {{0, 6, 11, 19, 35, 49, 82, 118, 185, 250, 324, 514, 736}, '14
                        {0, 4, 9, 15, 27, 38, 63, 91, 142, 192, 248, 394, 565}, '12
                        {0, 3, 6, 11, 20, 28, 47, 68, 106, 143, 185, 294, 421}, '10
                        {0, 1, 3, 6, 11, 15, 26, 37, 59, 79, 103, 163, 234}, '8
                        {0, 1, 2, 4, 8, 11, 19, 28, 43, 59, 76, 121, 173}, '6
                        {0, 1, 1, 3, 6, 8, 14, 20, 31, 42, 55, 87, 125}, '4
                        {0, 1, 1, 2, 4, 6, 10, 14, 22, 30, 39, 62, 89}} '2
            End Select

        ElseIf ConduitType = "Rigid PVC 40" Or ConduitType = "HDPE" Then
            Select Case WireType
                Case "RHH", "RHW", "RHW-2"
                    Conduit = {{0, 4, 7, 11, 20, 27, 45, 64, 99, 133, 171, 269, 390}, '14
                        {0, 3, 5, 9, 16, 22, 37, 53, 82, 110, 142, 224, 323}, '12
                        {0, 2, 4, 7, 13, 18, 30, 43, 66, 89, 115, 181, 261}, '10
                        {0, 1, 2, 4, 7, 9, 15, 22, 35, 46, 60, 94, 137}, '8
                        {0, 1, 1, 3, 5, 7, 12, 18, 28, 37, 48, 76, 109}, '6
                        {0, 1, 1, 2, 4, 6, 10, 14, 22, 29, 37, 59, 85}, '4
                        {0, 1, 1, 1, 3, 4, 7, 10, 16, 22, 28, 45, 65}, '2
                        {0, 0, 1, 1, 1, 3, 5, 7, 11, 14, 19, 29, 43}, '1
                        {0, 0, 1, 1, 1, 2, 4, 6, 9, 13, 16, 26, 37}, '1/0
                        {0, 0, 0, 1, 1, 1, 3, 5, 8, 11, 14, 22, 32}, '2/0
                        {0, 0, 0, 1, 1, 1, 3, 4, 7, 9, 12, 19, 28}, '3/0
                        {0, 0, 0, 1, 1, 1, 2, 4, 6, 8, 10, 16, 24}, '4/0
                        {0, 0, 0, 1, 1, 1, 1, 3, 4, 6, 8, 12, 18}, '250
                        {0, 0, 0, 1, 1, 1, 1, 2, 4, 5, 7, 11, 16}, '300
                        {0, 0, 0, 1, 1, 1, 1, 2, 3, 5, 6, 10, 14}, '350
                        {0, 0, 0, 1, 1, 1, 1, 1, 3, 4, 6, 9, 13}, '400
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 5, 8, 11}, '500
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 6, 8}, '700
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 8}, '750
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 7}, '800
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 7}, '900
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 3, 4, 6}} '1000
                Case "TW", "THHW", "THW", "THW-2"
                    Conduit = {{0, 8, 14, 24, 42, 57, 94, 135, 209, 280, 361, 568, 822}, '14
                        {0, 6, 11, 18, 32, 44, 72, 103, 160, 215, 277, 436, 631}, '12
                        {0, 4, 8, 13, 24, 32, 54, 77, 119, 160, 206, 325, 470}, '10
                        {0, 2, 4, 7, 13, 18, 30, 43, 66, 89, 115, 181, 261}, '8
                        {0, 1, 2, 4, 8, 11, 18, 26, 40, 53, 69, 109, 157}, '6
                        {0, 1, 1, 3, 6, 8, 13, 19, 30, 40, 51, 81, 117}, '4
                        {0, 1, 1, 2, 4, 6, 10, 14, 22, 29, 37, 59, 85}, '2
                        {0, 0, 1, 1, 3, 4, 7, 10, 15, 20, 26, 41, 60}, '1
                        {0, 0, 1, 1, 2, 3, 6, 8, 13, 17, 22, 35, 51}, '1/0
                        {0, 0, 1, 1, 1, 3, 5, 7, 11, 15, 19, 30, 43}, '2/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 9, 12, 16, 25, 36}, '3/0
                        {0, 0, 0, 1, 1, 1, 3, 5, 8, 10, 13, 21, 30}, '4/0
                        {0, 0, 0, 1, 1, 1, 3, 4, 6, 8, 11, 17, 25}, '250
                        {0, 0, 0, 1, 1, 1, 2, 3, 5, 7, 9, 15, 21}, '300
                        {0, 0, 0, 0, 1, 1, 1, 3, 5, 6, 8, 13, 19}, '350
                        {0, 0, 0, 0, 1, 1, 1, 3, 4, 6, 7, 12, 17}, '400
                        {0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 6, 10, 14}, '500
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 10}, '700
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 6, 10}, '750
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 6, 9}, '800
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 6, 8}, '900
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 7}} '1000
                Case "THHN", "THWN", "THWN-2"
                    Conduit = {{0, 11, 21, 34, 60, 82, 135, 193, 299, 401, 517, 815, 1178}, '14
                        {0, 8, 15, 25, 43, 59, 99, 141, 218, 293, 377, 594, 859}, '12
                        {0, 5, 9, 15, 27, 37, 62, 89, 137, 184, 238, 374, 541}, '10
                        {0, 3, 5, 9, 16, 21, 36, 51, 79, 106, 137, 216, 312}, '8
                        {0, 1, 4, 6, 11, 15, 26, 37, 57, 77, 99, 156, 225}, '6
                        {0, 1, 2, 4, 7, 9, 16, 22, 35, 47, 61, 96, 138}, '4
                        {0, 1, 1, 3, 5, 7, 11, 16, 25, 33, 43, 68, 98}, '2
                        {0, 1, 1, 1, 3, 5, 8, 12, 18, 25, 32, 50, 73}, '1
                        {0, 1, 1, 1, 3, 4, 7, 10, 15, 21, 28, 42, 61}, '1/0
                        {0, 0, 1, 1, 2, 3, 6, 8, 13, 17, 22, 35, 51}, '2/0
                        {0, 0, 1, 1, 1, 3, 5, 7, 11, 14, 18, 29, 42}, '3/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 9, 12, 15, 24, 35}, '4/0
                        {0, 0, 0, 1, 1, 1, 3, 4, 7, 10, 12, 20, 28}, '250
                        {0, 0, 0, 1, 1, 1, 3, 4, 6, 8, 11, 17, 24}, '300
                        {0, 0, 0, 1, 1, 1, 2, 3, 5, 1, 9, 15, 21}, '350
                        {0, 0, 0, 0, 1, 1, 1, 3, 5, 6, 8, 13, 19}, '400
                        {0, 0, 0, 0, 1, 1, 1, 2, 4, 5, 7, 11, 16}, '500
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 5, 8, 11}, '700
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 11}, '750
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 10}, '800
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 6, 9}, '900
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 6, 8}} '1000
                Case "FEP", "FEPB"
                    Conduit = {{0, 11, 20, 33, 58, 79, 131, 188, 290, 389, 502, 790, 1142}, '14
                        {0, 8, 15, 24, 42, 58, 96, 137, 212, 284, 366, 577, 834}, '12
                        {0, 6, 10, 17, 30, 41, 69, 98, 152, 204, 263, 414, 598}, '10
                        {0, 3, 6, 10, 17, 24, 39, 56, 87, 117, 150, 237, 343}, '8
                        {0, 2, 4, 7, 12, 17, 28, 40, 62, 83, 107, 169, 244}, '6
                        {0, 1, 3, 5, 8, 12, 19, 28, 43, 59, 75, 118, 170}, '4
                        {0, 1, 1, 3, 6, 8, 13, 19, 30, 40, 51, 81, 117}} '2
                Case "PFA", "PFAH", "TFE"
                    Conduit = {{0, 11, 20, 33, 58, 79, 131, 188, 290, 389, 502, 790, 1142}, '14
                        {0, 8, 15, 24, 42, 58, 96, 137, 212, 284, 366, 577, 834}, '12
                        {0, 6, 10, 17, 30, 41, 69, 98, 152, 204, 263, 414, 598}, '10
                        {0, 3, 6, 10, 17, 24, 39, 56, 87, 117, 150, 237, 343}, '8
                        {0, 2, 4, 7, 12, 17, 28, 40, 62, 83, 107, 169, 244}, '6
                        {0, 1, 3, 5, 8, 12, 19, 28, 43, 59, 75, 118, 170}, '4
                        {0, 1, 1, 3, 6, 8, 13, 19, 30, 40, 51, 81, 117}, '2
                        {0, 1, 1, 2, 4, 5, 9, 13, 20, 28, 36, 56, 81}, '1
                        {0, 1, 1, 1, 3, 4, 8, 11, 17, 23, 30, 47, 68}, '1/0
                        {0, 0, 1, 1, 3, 4, 6, 9, 14, 19, 24, 39, 56}, '2/0
                        {0, 0, 1, 1, 2, 3, 5, 7, 12, 16, 20, 32, 46}, '3/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 9, 13, 16, 26, 38}} '4/0
                Case "Z"
                    Conduit = {{0, 13, 24, 40, 70, 95, 158, 226, 350, 469, 605, 952, 1376}, '14
                        {0, 9, 17, 28, 49, 68, 112, 160, 248, 333, 429, 675, 976}, '12
                        {0, 6, 10, 17, 30, 41, 69, 98, 152, 204, 263, 414, 598}, '10
                        {0, 3, 6, 11, 19, 26, 43, 62, 96, 129, 166, 261, 378}, '8
                        {0, 2, 4, 7, 13, 18, 30, 43, 67, 90, 116, 184, 265}, '6
                        {0, 1, 3, 5, 9, 12, 21, 30, 46, 62, 80, 126, 183}, '4
                        {0, 1, 1, 3, 5, 7, 12, 18, 28, 38, 49, 77, 111}, '2
                        {0, 1, 1, 2, 4, 6, 10, 14, 23, 30, 39, 62, 90}, '1
                        {0, 1, 1, 1, 3, 4, 8, 11, 17, 23, 30, 47, 68}, '1/0
                        {0, 0, 1, 1, 3, 4, 6, 9, 14, 19, 24, 39, 56}, '2/0
                        {0, 0, 1, 1, 2, 3, 5, 7, 12, 16, 20, 32, 46}, '3/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 9, 13, 16, 26, 38}} '4/0
                Case "XHHW", "XHHW-2", "XHH"
                    Conduit = {{0, 8, 14, 24, 42, 57, 94, 135, 209, 280, 361, 568, 822}, '14
                        {0, 6, 11, 18, 32, 44, 72, 103, 160, 215, 277, 436, 631}, '12
                        {0, 4, 8, 13, 24, 32, 54, 77, 119, 160, 206, 325, 470}, '10
                        {0, 2, 4, 7, 13, 18, 30, 43, 66, 89, 115, 181, 261}, '8
                        {0, 1, 3, 5, 10, 13, 22, 32, 49, 66, 85, 134, 193}, '6
                        {0, 1, 2, 4, 7, 9, 16, 23, 35, 48, 61, 97, 140}, '4
                        {0, 1, 1, 3, 5, 7, 11, 16, 25, 34, 44, 69, 99}, '2
                        {0, 1, 1, 1, 3, 5, 8, 12, 19, 25, 32, 51, 74}, '1
                        {0, 1, 1, 1, 3, 4, 7, 10, 16, 21, 27, 43, 62}, '1/0
                        {0, 0, 1, 1, 2, 3, 6, 8, 13, 17, 23, 36, 52}, '2/0
                        {0, 0, 1, 1, 1, 3, 5, 7, 11, 14, 19, 30, 43}, '3/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 9, 12, 15, 24, 35}, '4/0
                        {0, 0, 0, 1, 1, 1, 3, 5, 7, 10, 13, 20, 29}, '250
                        {0, 0, 0, 1, 1, 1, 3, 4, 6, 8, 11, 17, 25}, '300
                        {0, 0, 0, 1, 1, 1, 2, 3, 5, 7, 9, 15, 22}, '350
                        {0, 0, 0, 0, 1, 1, 1, 3, 5, 6, 8, 13, 19}, '400
                        {0, 0, 0, 0, 1, 1, 1, 2, 4, 5, 7, 11, 16}, '500
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 5, 8, 11}, '700
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 11}, '750
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 10}, '800
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 6, 9}, '900
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 6, 8}} '1000
                Case "ZW"
                    Conduit = {{0, 8, 14, 24, 42, 57, 94, 135, 209, 280, 361, 568, 822}, '14
                        {0, 6, 11, 18, 32, 44, 72, 103, 160, 215, 277, 436, 631}, '12
                        {0, 4, 8, 13, 24, 32, 54, 77, 119, 160, 206, 325, 470}, '10
                        {0, 2, 4, 7, 13, 18, 30, 43, 66, 89, 115, 181, 261}, '8
                        {0, 1, 3, 5, 10, 13, 22, 32, 49, 66, 85, 134, 193}, '6
                        {0, 1, 2, 4, 7, 9, 16, 23, 35, 48, 61, 97, 140}, '4
                        {0, 1, 1, 3, 5, 7, 11, 16, 25, 34, 44, 69, 99}} '2
            End Select
        ElseIf ConduitType = "RMC" Then
            Select Case WireType
                Case "RHH", "RHW", "RHW-2"
                    Conduit = {{0, 4, 7, 12, 21, 28, 46, 66, 102, 136, 176, 276, 398}, '14
                        {0, 3, 6, 10, 17, 23, 38, 55, 85, 113, 146, 229, 330}, '12
                        {0, 3, 5, 8, 14, 19, 31, 44, 68, 91, 118, 185, 267}, '10
                        {0, 1, 2, 4, 7, 10, 16, 23, 36, 48, 61, 97, 139}, '8
                        {0, 1, 1, 3, 6, 8, 13, 18, 29, 38, 49, 77, 112}, '6
                        {0, 1, 1, 2, 4, 6, 10, 14, 22, 30, 38, 60, 87}, '4
                        {0, 1, 1, 1, 3, 4, 7, 11, 17, 23, 29, 46, 66}, '2
                        {0, 0, 1, 1, 1, 3, 5, 7, 11, 15, 19, 30, 44}, '1
                        {0, 0, 1, 1, 1, 2, 4, 6, 10, 13, 17, 26, 38}, '1/0
                        {0, 0, 1, 1, 1, 2, 4, 5, 8, 11, 14, 23, 33}, '2/0
                        {0, 0, 0, 1, 1, 1, 3, 4, 7, 10, 12, 20, 28}, '3/0
                        {0, 0, 0, 1, 1, 1, 3, 4, 6, 8, 11, 17, 24}, '4/0
                        {0, 0, 0, 0, 1, 1, 1, 3, 4, 6, 8, 13, 18}, '250
                        {0, 0, 0, 0, 1, 1, 1, 2, 4, 5, 7, 11, 16}, '300
                        {0, 0, 0, 0, 1, 1, 1, 2, 4, 5, 6, 10, 15}, '350
                        {0, 0, 0, 0, 1, 1, 1, 1, 3, 4, 6, 9, 13}, '400
                        {0, 0, 0, 0, 1, 1, 1, 1, 3, 4, 5, 8, 11}, '500
                        {0, 0, 0, 0, 0, 1, 1, 1, 1, 3, 3, 6, 8}, '700
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 5, 8}, '750
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 7}, '800
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 7}, '900
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 3, 4, 6}} '1000
                Case "TW", "THHW", "THW", "THW-2"
                    Conduit = {{0, 9, 15, 25, 44, 59, 98, 140, 215, 288, 370, 581, 839}, '14
                        {0, 7, 12, 19, 33, 45, 75, 107, 165, 221, 284, 446, 644}, '12
                        {0, 5, 9, 14, 25, 34, 45, 80, 123, 164, 212, 332, 480}, '10
                        {0, 3, 5, 8, 14, 19, 31, 44, 68, 91, 117, 185, 267}, '8
                        {0, 1, 3, 5, 8, 11, 18, 27, 41, 55, 71, 111, 160}, '6
                        {0, 1, 1, 3, 6, 8, 14, 20, 31, 41, 53, 83, 120}, '4
                        {0, 1, 1, 2, 4, 6, 10, 14, 22, 30, 38, 60, 87}, '2
                        {0, 1, 1, 1, 3, 4, 7, 10, 15, 21, 27, 42, 61}, '1
                        {0, 0, 1, 1, 2, 3, 6, 8, 13, 18, 23, 36, 52}, '1/0
                        {0, 0, 1, 1, 2, 3, 5, 7, 11, 15, 19, 31, 44}, '2/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 9, 13, 16, 26, 37}, '3/0
                        {0, 0, 0, 1, 1, 1, 3, 5, 8, 10, 14, 21, 31}, '4/0
                        {0, 0, 0, 1, 1, 1, 3, 4, 6, 8, 11, 17, 25}, '250
                        {0, 0, 0, 1, 1, 1, 3, 3, 5, 7, 9, 15, 22}, '300
                        {0, 0, 0, 0, 1, 1, 2, 3, 5, 6, 8, 13, 19}, '350
                        {0, 0, 0, 0, 1, 1, 1, 3, 4, 6, 7, 12, 17}, '400
                        {0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 6, 10, 14}, '500
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 10}, '700
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 10}, '750
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 6, 9}, '800
                        {0, 0, 0, 0, 0, 1, 1, 1, 1, 3, 3, 6, 8}, '900
                        {0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 5, 8}} '1000
                Case "THHN", "THWN", "THWN-2"
                    Conduit = {{0, 13, 22, 36, 63, 85, 140, 200, 309, 412, 531, 833, 1202}, '14
                        {0, 9, 16, 26, 46, 62, 102, 146, 225, 301, 387, 608, 877}, '12
                        {0, 6, 10, 17, 29, 39, 64, 92, 142, 189, 244, 383, 552}, '10
                        {0, 3, 6, 9, 16, 22, 37, 53, 82, 109, 140, 221, 318}, '8
                        {0, 2, 4, 7, 12, 16, 27, 38, 59, 79, 101, 159, 230}, '6
                        {0, 1, 2, 4, 7, 10, 16, 23, 36, 48, 62, 98, 141}, '4
                        {0, 1, 1, 3, 5, 7, 11, 17, 26, 34, 44, 70, 100}, '2
                        {0, 1, 1, 1, 4, 5, 8, 12, 19, 25, 33, 51, 74}, '1
                        {0, 1, 1, 1, 3, 4, 7, 10, 16, 21, 27, 43, 63}, '1/0
                        {0, 0, 1, 1, 2, 3, 6, 8, 13, 18, 23, 36, 52}, '2/0
                        {0, 0, 1, 1, 1, 3, 5, 7, 11, 15, 19, 30, 43}, '3/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 9, 12, 16, 25, 36}, '4/0
                        {0, 0, 0, 1, 1, 1, 3, 5, 7, 10, 13, 20, 29}, '250
                        {0, 0, 0, 1, 1, 1, 3, 4, 6, 8, 11, 17, 25}, '300
                        {0, 0, 0, 1, 1, 1, 2, 3, 5, 7, 10, 15, 22}, '350
                        {0, 0, 0, 1, 1, 1, 2, 3, 5, 7, 8, 13, 20}, '400
                        {0, 0, 0, 0, 1, 1, 1, 2, 4, 5, 7, 11, 16}, '500
                        {0, 0, 0, 0, 1, 1, 1, 1, 3, 4, 5, 8, 11}, '700
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 5, 7, 11}, '750
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 10}, '800
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 6, 9}, '900
                        {0, 0, 0, 0, 0, 1, 1, 1, 1, 3, 4, 6, 8}} '1000
                Case "FEP", "FEPB"
                    Conduit = {{0, 12, 22, 35, 61, 83, 136, 194, 300, 400, 515, 808, 1166}, '14
                        {0, 9, 16, 26, 44, 60, 99, 142, 219, 292, 376, 590, 851}, '12
                        {0, 6, 11, 18, 32, 43, 71, 102, 157, 209, 269, 423, 610}, '10
                        {0, 3, 6, 10, 18, 25, 41, 58, 90, 120, 154, 242, 350}, '8
                        {0, 2, 4, 7, 13, 17, 29, 41, 64, 85, 110, 172, 249}, '6
                        {0, 1, 3, 5, 9, 12, 20, 29, 44, 59, 77, 120, 174}, '4
                        {0, 1, 1, 3, 6, 8, 14, 20, 31, 41, 53, 83, 120}} '2
                Case "PFA", "PFAH", "TFE"
                    Conduit = {{0, 12, 22, 35, 61, 83, 136, 194, 300, 400, 515, 808, 1166}, '14
                        {0, 9, 16, 26, 44, 60, 99, 142, 219, 292, 376, 590, 851}, '12
                        {0, 6, 11, 18, 32, 43, 71, 102, 157, 209, 269, 423, 610}, '10
                        {0, 3, 6, 10, 18, 25, 41, 58, 90, 120, 154, 242, 350}, '8
                        {0, 2, 4, 7, 13, 17, 29, 41, 64, 85, 110, 172, 249}, '6
                        {0, 1, 3, 5, 9, 12, 20, 29, 44, 59, 77, 120, 174}, '4
                        {0, 1, 1, 3, 6, 8, 14, 20, 31, 41, 53, 83, 120}, '2
                        {0, 1, 1, 2, 4, 6, 9, 14, 21, 28, 37, 57, 83}, '1
                        {0, 1, 1, 1, 3, 5, 8, 11, 18, 24, 30, 48, 69}, '1/0
                        {0, 1, 1, 1, 3, 4, 6, 9, 14, 19, 25, 40, 57}, '2/0
                        {0, 0, 1, 1, 2, 3, 5, 8, 12, 16, 21, 33, 47}, '3/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 10, 13, 17, 27, 39}} '4/0
                Case "Z"
                    Conduit = {{0, 15, 26, 42, 73, 100, 164, 234, 361, 482, 621, 974, 1405}, '14
                        {0, 10, 18, 30, 52, 71, 116, 166, 256, 342, 440, 691, 997}, '12
                        {0, 6, 11, 18, 32, 43, 71, 102, 157, 209, 269, 423, 610}, '10
                        {0, 4, 7, 11, 20, 27, 45, 64, 99, 132, 170, 267, 386}, '8
                        {0, 3, 5, 8, 14, 19, 31, 45, 69, 93, 120, 188, 271}, '6
                        {0, 1, 3, 5, 9, 13, 22, 31, 48, 64, 82, 129, 186}, '4
                        {0, 1, 1, 3, 6, 8, 13, 19, 29, 39, 50, 78, 113}, '2
                        {0, 1, 1, 2, 5, 6, 10, 15, 23, 31, 40, 63, 92}, '1
                        {0, 1, 1, 1, 3, 5, 8, 11, 18, 24, 30, 48, 69}, '1/0
                        {0, 1, 1, 1, 3, 4, 6, 9, 14, 19, 25, 40, 57}, '2/0
                        {0, 0, 1, 1, 2, 3, 5, 8, 12, 16, 21, 33, 47}, '3/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 10, 13, 17, 27, 39}} '4/0
                Case "XHHW", "XHHW-2", "XHH"
                    Conduit = {{0, 9, 15, 25, 44, 59, 98, 140, 215, 288, 370, 581, 839}, '14
                        {0, 7, 12, 19, 33, 45, 75, 107, 165, 221, 284, 446, 644}, '12
                        {0, 5, 9, 14, 25, 34, 56, 80, 123, 164, 212, 332, 480}, '10
                        {0, 3, 5, 8, 14, 19, 31, 44, 68, 91, 118, 185, 267}, '8
                        {0, 1, 3, 6, 10, 14, 23, 33, 51, 68, 87, 137, 197}, '6
                        {0, 1, 2, 4, 7, 10, 16, 24, 37, 49, 63, 99, 143}, '4
                        {0, 1, 1, 3, 5, 7, 12, 17, 26, 35, 45, 70, 101}, '2
                        {0, 1, 1, 1, 4, 5, 9, 12, 19, 26, 33, 52, 76}, '1
                        {0, 1, 1, 1, 3, 4, 7, 10, 16, 22, 28, 44, 64}, '1/0
                        {0, 0, 1, 1, 2, 3, 6, 9, 13, 18, 23, 37, 53}, '2/0
                        {0, 0, 1, 1, 1, 3, 5, 7, 11, 15, 19, 30, 44}, '3/0
                        {0, 0, 1, 1, 1, 2, 4, 6, 9, 12, 16, 25, 36}, '4/0
                        {0, 0, 0, 1, 1, 1, 3, 5, 7, 10, 13, 20, 30}, '250
                        {0, 0, 0, 1, 1, 1, 3, 4, 6, 9, 11, 18, 25}, '300
                        {0, 0, 0, 1, 1, 1, 2, 3, 6, 7, 10, 15, 22}, '350
                        {0, 0, 0, 1, 1, 1, 2, 3, 5, 7, 9, 14, 20}, '400
                        {0, 0, 0, 0, 1, 1, 1, 2, 4, 5, 7, 11, 16}, '500
                        {0, 0, 0, 0, 1, 1, 1, 1, 3, 4, 5, 8, 11}, '700
                        {0, 0, 0, 0, 0, 1, 1, 1, 3, 4, 5, 7, 11}, '750
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 7, 10}, '800
                        {0, 0, 0, 0, 0, 1, 1, 1, 2, 3, 4, 6, 9}, '900
                        {0, 0, 0, 0, 0, 1, 1, 1, 1, 3, 4, 6, 8}} '1000
                Case "ZW"
                    Conduit = {{0, 9, 15, 25, 44, 59, 98, 140, 215, 288, 370, 581, 839}, '14
                        {0, 7, 12, 19, 33, 45, 75, 107, 165, 221, 284, 446, 644}, '12
                        {0, 5, 9, 14, 25, 34, 56, 80, 123, 164, 212, 332, 480}, '10
                        {0, 3, 5, 8, 14, 19, 31, 44, 68, 91, 118, 185, 267}, '8
                        {0, 1, 3, 6, 10, 14, 23, 33, 51, 68, 87, 137, 197}, '6
                        {0, 1, 2, 4, 7, 10, 16, 24, 37, 49, 63, 99, 143}, '4
                        {0, 1, 1, 3, 5, 7, 12, 17, 26, 35, 45, 70, 101}} '2
            End Select
        End If

        If (Phase IsNot "3" And (Ground Xor Neutral)) Or (Phase = "3" And Ground = False And Neutral = False) Then
            z = 3
        ElseIf Phase IsNot "3" And Ground = False And Neutral = False Then
            z = 2
        ElseIf (Phase = "3" And Ground = True And Neutral = False) Or (Phase = "3" And Ground = False And Neutral = True) Or (Phase IsNot "3" And Ground = True And Neutral = True) Then
            z = 4
        ElseIf Phase = "3" And Ground = True And Neutral = True Then
            z = 5
        End If

        For j As Integer = 1 To 12 Step 1
            If Conduit(v, j) >= z And Conduit(v, j - 1) <= z Then
                w = j
                GoTo ReturnLine
            End If
        Next

        NominalSize(w) = -1

ReturnLine: Return NominalSize(w)
    End Function

    Public Function GroundWire(ByVal CurrentRating As Decimal, Conductor As String) As String
        Dim GroundSize(21) As String
        Dim v, OCPD(21) As Integer

        OCPD = {0, 15, 20, 30, 40, 60, 100, 200, 300, 400, 500, 600, 800, 1000, 1200, 1600, 2000, 2500, 3000, 4000, 5000, 6000}

        If CurrentRating > 6000 Then
            v = 21
        Else
            For i As Integer = 1 To 21
                If CurrentRating <= OCPD(i) And CurrentRating > OCPD(i - 1) Then
                    v = i
                End If
            Next i
        End If

        If Conductor = "Cu" Then
            GroundSize = {"", "2.0", "3.5", "5.5", "5.5", "5.5", "8.0", "14", "22", "30", "30", "38", "50", "60", "80", "100", "125", "175", "200", "250", "375", "400"}
        Else
            GroundSize = {"", "3.5", "5.5", "8.0", "8.0", "8.0", "14", "22", "30", "38", "50", "60", "80", "100", "125", "175", "200", "325", "325", "375", "600", "600"}
        End If

        Return GroundSize(v)
    End Function

    Public Function LineImpedance(ByVal Length As Decimal, Conduit As String, ByVal WireSize As Decimal, Conductor As String, ByVal Voltage As Integer, ByVal LineSet As Integer) As Complex
        Dim Zline As Complex
        Dim x As Integer

        Dim Size(20), NominalXL(20), NominalR(20), TrueR, TrueXL, Zbase As Decimal
        Size = {2.0, 3.5, 5.5, 8.0, 14, 22, 30, 38, 50, 60, 80, 100, 125, 150, 175, 200, 250, 325, 375, 400, 500}

        For i As Integer = 0 To 20
            If Size(i) = WireSize Then
                x = i
            End If
        Next i

        Select Case Conduit
            Case "Rigid PVC 80", "Rigid PVC 40", "HDPE"
                NominalXL = {0.058, 0.054, 0.05, 0.052, 0.051, 0.048, 0.045, 0.046, 0.044, 0.043, 0.042, 0.041, 0.041, 0.041, 0.04, 0.04, 0.039, 0.039, 0.038, 0.038, 0.037}
                If Conductor = "Cu" Then
                    NominalR = {3.1, 2.0, 1.2, 0.78, 0.49, 0.31, 0.19, 0.15, 0.12, 0.1, 0.077, 0.062, 0.052, 0.044, 0.038, 0.033, 0.027, 0.023, 0.019, 0.019, 0.015}
                Else
                    NominalR = {0, 3.2, 2.0, 1.3, 0.81, 0.51, 0.32, 0.25, 0.2, 0.16, 0.13, 0.1, 0.085, 0.071, 0.061, 0.054, 0.043, 0.036, 0.029, 0.029, 0.023}
                End If
            Case Else
                NominalXL = {0.073, 0.068, 0.063, 0.065, 0.064, 0.06, 0.057, 0.057, 0.055, 0.054, 0.052, 0.051, 0.052, 0.051, 0.05, 0.049, 0.048, 0.048, 0.048, 0.048, 0.046}
                If Conductor = "Cu" Then
                    NominalR = {3.1, 2.0, 1.2, 0.78, 0.49, 0.31, 0.2, 0.16, 0.12, 0.1, 0.079, 0.063, 0.054, 0.045, 0.039, 0.035, 0.029, 0.025, 0.021, 0.021, 0.018}
                Else
                    NominalR = {0, 3.2, 2.0, 1.3, 0.81, 0.51, 0.32, 0.25, 0.2, 0.16, 0.13, 0.1, 0.086, 0.072, 0.063, 0.055, 0.045, 0.038, 0.031, 0.031, 0.025}
                End If
        End Select

        TrueR = NominalR(x) * Length / 305
        TrueXL = NominalXL(x) * Length / 305

        Dim Zohms = New Complex(TrueR / LineSet, TrueXL / LineSet)

        Zbase = (Voltage ^ 2) / 1000000

        Zline = Zohms / Zbase

        Return Zline
    End Function

    Public Function LoadImpedance(ByVal Load As Decimal) As Complex
        Dim Zload As Complex
        Dim Zmotor = New Complex(0.07, 0.24)

        Zload = Zmotor * (1000000 / Load)

        Return Zload
    End Function
End Module
